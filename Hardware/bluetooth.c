#include "bluetooth.h"

uint8_t USART2_RX_BUF[USART2_REC_LEN];//???????,???USART_REC_LEN?????.
uint16_t USART2_RX_STA=0;//?????????//bit15?????????????bit14~0???????????§¹??????
uint8_t USART2_NewData;//????????§Ø?????1?????????????

void  HAL_UART_RxCpltCallback(UART_HandleTypeDef  *huart)//?????§Ø???????
{
    if(huart ==&huart2)
    {
        if((USART2_RX_STA&0x8000)==0)//????¦Ä???
        {
            if(USART2_NewData==0x5A)//???????0x5A
            {
				USART2_RX_STA = 0;
            }
            else
            {
                   USART2_RX_BUF[USART2_RX_STA&0X7FFF]=USART2_NewData; //?????????????????ï…
                   USART2_RX_STA++;  //????????????1
                   if(USART2_RX_STA>(USART2_REC_LEN-1))USART2_RX_STA=0;//???????????,??????????

            }
        }
        HAL_UART_Receive_IT(&huart2,(uint8_t *)&USART2_NewData,1); //?????????????§Ø??????????????§Ø???????????????????????????§Ø?


    }
}

